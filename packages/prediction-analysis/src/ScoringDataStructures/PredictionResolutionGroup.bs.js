// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var Block = require("bs-platform/lib/js/block.js");
var Curry = require("bs-platform/lib/js/curry.js");
var Caml_option = require("bs-platform/lib/js/caml_option.js");
var Percentage$PredictionAnalysis = require("../Measurement/Percentage.bs.js");

var WithMarket = /* module */[];

function map(param, t) {
  var variant = t[0];
  if (variant !== 563749152) {
    if (variant >= 1067596532) {
      return /* `PercentagePercentage */[
              1067596532,
              Curry._1(param[2], t[1])
            ];
    } else {
      return /* `CdfFloat */[
              348210391,
              Curry._1(param[1], t[1])
            ];
    }
  } else {
    return /* `CdfCdf */[
            563749152,
            Curry._1(param[0], t[1])
          ];
  }
}

function combinationToMarket(param) {
  var marketPrediction = param[/* marketPrediction */1];
  if (marketPrediction !== undefined) {
    return /* record */[
            /* agentPrediction */param[/* agentPrediction */0],
            /* marketPrediction */Caml_option.valFromOption(marketPrediction),
            /* resolution */param[/* resolution */2]
          ];
  }
  
}

function toWithMarket(t) {
  var t$1 = map(/* tuple */[
        combinationToMarket,
        combinationToMarket,
        combinationToMarket
      ], t);
  if (typeof t$1 === "number") {
    return undefined;
  } else {
    var variant = t$1[0];
    if (variant !== 348210391) {
      if (variant !== 563749152) {
        if (variant !== 1067596532) {
          return undefined;
        } else {
          var match = t$1[1];
          if (match !== undefined) {
            return /* `PercentagePercentage */[
                    1067596532,
                    Caml_option.valFromOption(match)
                  ];
          } else {
            return undefined;
          }
        }
      } else {
        var match$1 = t$1[1];
        if (match$1 !== undefined) {
          return /* `CdfCdf */[
                  563749152,
                  Caml_option.valFromOption(match$1)
                ];
        } else {
          return undefined;
        }
      }
    } else {
      var match$2 = t$1[1];
      if (match$2 !== undefined) {
        return /* `CdfFloat */[
                348210391,
                Caml_option.valFromOption(match$2)
              ];
      } else {
        return undefined;
      }
    }
  }
}

function make(agentPrediction, $staropt$star, resolution, param) {
  var marketPrediction = $staropt$star !== undefined ? Caml_option.valFromOption($staropt$star) : undefined;
  if (typeof agentPrediction === "number") {
    return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
  } else {
    var variant = agentPrediction[0];
    if (variant !== -488794310) {
      if (variant !== 3354245) {
        return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
      } else {
        var agentPrediction$1 = agentPrediction[1];
        if (marketPrediction !== undefined) {
          var match = marketPrediction;
          if (typeof match === "number" || match[0] !== 3354245 || typeof resolution === "number") {
            return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
          } else {
            var variant$1 = resolution[0];
            var marketPrediction$1 = match[1];
            if (variant$1 !== 3354245) {
              if (variant$1 !== 365180284) {
                return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
              } else {
                return /* Ok */Block.__(0, [/* `CdfFloat */[
                            348210391,
                            /* record */[
                              /* agentPrediction */agentPrediction$1,
                              /* marketPrediction */Caml_option.some(marketPrediction$1),
                              /* resolution */resolution[1]
                            ]
                          ]]);
              }
            } else {
              return /* Ok */Block.__(0, [/* `CdfCdf */[
                          563749152,
                          /* record */[
                            /* agentPrediction */agentPrediction$1,
                            /* marketPrediction */Caml_option.some(marketPrediction$1),
                            /* resolution */resolution[1]
                          ]
                        ]]);
            }
          }
        } else if (typeof resolution === "number") {
          return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
        } else {
          var variant$2 = resolution[0];
          if (variant$2 !== 3354245) {
            if (variant$2 !== 365180284) {
              return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
            } else {
              return /* Ok */Block.__(0, [/* `CdfFloat */[
                          348210391,
                          /* record */[
                            /* agentPrediction */agentPrediction$1,
                            /* marketPrediction */undefined,
                            /* resolution */resolution[1]
                          ]
                        ]]);
            }
          } else {
            return /* Ok */Block.__(0, [/* `CdfCdf */[
                        563749152,
                        /* record */[
                          /* agentPrediction */agentPrediction$1,
                          /* marketPrediction */undefined,
                          /* resolution */resolution[1]
                        ]
                      ]]);
          }
        }
      }
    } else {
      var agentPrediction$2 = agentPrediction[1];
      if (marketPrediction !== undefined) {
        var match$1 = marketPrediction;
        if (typeof match$1 === "number" || match$1[0] !== -488794310 || typeof resolution === "number") {
          return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
        } else {
          var variant$3 = resolution[0];
          var marketPrediction$2 = match$1[1];
          if (variant$3 !== -488794310) {
            if (variant$3 !== 564146209) {
              return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
            } else {
              return /* Ok */Block.__(0, [/* `PercentagePercentage */[
                          1067596532,
                          /* record */[
                            /* agentPrediction */agentPrediction$2,
                            /* marketPrediction */Caml_option.some(marketPrediction$2),
                            /* resolution */Percentage$PredictionAnalysis.fromBool(resolution[1])
                          ]
                        ]]);
            }
          } else {
            return /* Ok */Block.__(0, [/* `PercentagePercentage */[
                        1067596532,
                        /* record */[
                          /* agentPrediction */agentPrediction$2,
                          /* marketPrediction */Caml_option.some(marketPrediction$2),
                          /* resolution */resolution[1]
                        ]
                      ]]);
          }
        }
      } else if (typeof resolution === "number") {
        return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
      } else {
        var variant$4 = resolution[0];
        if (variant$4 !== -488794310) {
          if (variant$4 !== 564146209) {
            return /* Error */Block.__(1, ["#toValidScoringCombination error: Scoring Combination Not Valid."]);
          } else {
            return /* Ok */Block.__(0, [/* `PercentagePercentage */[
                        1067596532,
                        /* record */[
                          /* agentPrediction */agentPrediction$2,
                          /* marketPrediction */undefined,
                          /* resolution */Percentage$PredictionAnalysis.fromBool(resolution[1])
                        ]
                      ]]);
          }
        } else {
          return /* Ok */Block.__(0, [/* `PercentagePercentage */[
                      1067596532,
                      /* record */[
                        /* agentPrediction */agentPrediction$2,
                        /* marketPrediction */undefined,
                        /* resolution */resolution[1]
                      ]
                    ]]);
        }
      }
    }
  }
}

var fromArbitraryMeasurementValues = make;

exports.WithMarket = WithMarket;
exports.fromArbitraryMeasurementValues = fromArbitraryMeasurementValues;
exports.toWithMarket = toWithMarket;
/* No side effect */
